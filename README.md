# Claude Code Web Terminal

Raspberry Pi 5 上で動作する **Web ベースのターミナルアプリケーション**です。  
LAN 内の他のデバイス（PC、スマートフォン、タブレット）からブラウザ経由でターミナル操作ができます。

## 特徴

- 🖥️ **ブラウザからターミナルアクセス** - xterm.js による本格的なターミナル体験
- 📱 **モバイル対応** - タッチ操作に最適化された特殊キーツールバー
- 🔄 **セッション永続化** - tmux によりブラウザを閉じてもセッション維持
- 📲 **PWA 対応** - ホーム画面に追加してアプリのように使用可能
- 🔌 **自動再接続** - 接続断時に自動的に復旧

## アーキテクチャ

```
┌─────────────────────────────────────────────────────────────┐
│                   クライアント（ブラウザ）                    │
│  ┌───────────┐  ┌────────────┐  ┌───────────────────────┐   │
│  │  xterm.js │  │  Socket.io │  │  PWA (ServiceWorker) │   │
│  │ ターミナル │←→│    通信    │  │   オフライン対応      │   │
│  └───────────┘  └────────────┘  └───────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            ↓↑ WebSocket
┌─────────────────────────────────────────────────────────────┐
│                    サーバー (Node.js)                        │
│  ┌────────┐  ┌────────────┐  ┌───────────────────────────┐  │
│  │Express │  │  Socket.io │  │        node-pty          │  │
│  │静的配信│  │   接続管理  │  │   擬似ターミナル制御      │  │
│  └────────┘  └────────────┘  └───────────────────────────┘  │
│                            ↓↑                              │
│  ┌─────────────────────────────────────────────────────────┐│
│  │                        tmux                            ││
│  │          セッション永続化・マルチプレクサ                 ││
│  └─────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

## 必要要件

- Node.js 18+
- tmux
- Linux 環境（Raspberry Pi OS 推奨）

## インストール

```bash
# リポジトリをクローン
git clone https://github.com/your-username/claude-code-web.git
cd claude-code-web

# 依存関係をインストール
npm install

# tmux がインストールされていない場合
sudo apt install tmux
```

## 使い方

### サーバー起動

```bash
npm start
```

サーバーは `http://0.0.0.0:3000` で起動します。

### アクセス

同じ LAN 内のデバイスから以下の URL でアクセス：

```
http://<Raspberry Pi の IP アドレス>:3000
```

例: `http://192.168.1.100:3000`

## 機能詳細

### セッション管理

- セッション名は `ccw_` プレフィックス付きで自動生成
- 複数セッションの作成・切り替え・削除が可能
- ブラウザを閉じてもセッションは維持される

### モバイル向け UI

| 機能 | 説明 |
|------|------|
| 特殊キーツールバー | Esc, Tab, Ctrl+C/D/L/Z, 矢印キー, PgUp/PgDn |
| スクロールモード | tmux コピーモードで履歴をスクロール |
| クリップボード操作 | コピー/ペーストボタン |
| クイックアクション | `claude`, `clear`, `exit` ボタン |

### 設定

- **フォントサイズ**: 10px〜24px で調整可能
- **カスタムコマンド**: よく使うコマンドをボタンとして追加

設定は LocalStorage に保存され、次回アクセス時に復元されます。

## ファイル構成

```
claude-code-web/
├── server.js           # Express + Socket.io サーバー
├── package.json        # 依存関係定義
├── public/
│   ├── index.html      # フロントエンド HTML
│   ├── js/
│   │   └── terminal.js # ターミナル制御ロジック
│   ├── css/
│   │   └── style.css   # レスポンシブ CSS
│   ├── icons/
│   │   └── icon.svg    # アプリアイコン
│   ├── manifest.json   # PWA マニフェスト
│   └── sw.js           # Service Worker
└── README.md
```

## 技術スタック

- **フロントエンド**
  - [xterm.js](https://xtermjs.org/) - ターミナルエミュレータ
  - [Socket.io Client](https://socket.io/) - WebSocket 通信
  - Service Worker - PWA / オフライン対応

- **バックエンド**
  - [Express](https://expressjs.com/) - Web サーバー
  - [Socket.io](https://socket.io/) - リアルタイム通信
  - [node-pty](https://github.com/microsoft/node-pty) - 擬似ターミナル
  - [tmux](https://github.com/tmux/tmux) - セッション管理

## ライセンス

MIT
